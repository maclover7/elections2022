# allegheny-adder

Adds up election results for specific legislative districts in Allegheny
County.

### Usage

##### Download county map

Before election day, update the `election_id` in `config.json`, and run
`node download-map-county.js` to download the county precinct map. This will
generate a file called `output/map-county-ELECTIONID.geojson`.

##### Generate race results

Before election day, update the `races` array in `config.json`. There
should be one array per tracked race, with the first field as a race
name of your selection, followed by the race ID number utilized in the
Clarity election system.

On election day, run `download-results-race.js` to download results
for the tracked races.

##### Generate race map

At the start of election day, after you've already downloaded the county
map and downloaded zero-count race results, run `create-map-race.js` to
generate precinct maps for each tracked race.


##### Creating Datawrapper visualization

- Head to Datawrapper and create a new chloropleth map
- Upload the `output/map-race-RACENAME.geojson` file generated by
  `create-map-race.js`
- Upload the `output/results-race-RACENAME.csv` file generated by
  `download-results-race.js`
- Remove the final row, which has `-1` as the precinct name, and
  contains summed results for the race
- Select `dem_pct` as the color column, and insert the following as
  the color preset: `#b2182b,#ef8a62,#d1e5f0,#67a9cf,#2166ac`
- You could also select `rep_pct` as the color column, but would need to
  adjust the color preset accordingly
- Under custom range, change the center value to 50
- Insert a title, description and graphic credit
- Insert the source: `Allegheny County Elections Division`
- Select to show map labels
- Click customize tooltips to open a dropdown menu, and insert something
  similar to the following. You can pick the candidate order:

```
DEMCANDIDATENAMEHERE (D): {{ dem_total }}; {{ dem_pct }}%

REPCANDIDATENAMEHERE (R): {{ rep_total }}; {{ rep_pct }}%

Write-in: {{ wi_total }}; {{ wi_pct }}%

Total votes: {{ precinct_total }}
```

- Proof your map, and then click publish to get the embed code
